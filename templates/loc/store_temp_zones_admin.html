{% extends "layout/base.html" %}
{% block title %}{{ t("inventory.zone_master", "__inventory.zone_master__") }}{% endblock %}

{% block content %}
<h2>{{ t("inventory.zone_master", "__inventory.zone_master__") }}</h2>

<form method="get" action="{{ url_for('store_temp_zones_admin') }}" style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
  <label class="field-label">{{ t("form.store", "__form.store__") }}:</label>
  <select name="store_id" onchange="this.form.submit()">
    <option value="">{{ t("common.all_stores", "__common.all_stores__") }}</option>
    {% for s in stores %}
      <option value="{{ s.id }}" {% if selected_store_id == s.id %}selected{% endif %}>{{ s.name }}</option>
    {% endfor %}
  </select>
</form>

{% if selected_store_id %}
<form method="post" action="{{ url_for('store_temp_zones_admin_save') }}" style="margin-top:12px;">
  <input type="hidden" name="store_id" value="{{ selected_store_id }}">

  <table class="table table-bordered">
    <thead>
      <tr>
        <th style="width:90px;">{{ t("common.use", "__common.use__") }}</th>
        <th style="width:120px;">Code</th>
        <th>{{ t("common.name", "__common.name__") }}</th>
        <th style="width:120px;">{{ t("common.sort_order", "__common.sort_order__") }}</th>
      </tr>
    </thead>
    <tbody>
      {% for z in tz_master %}
        {% set srow = store_tz.get(z.code) %}
        <tr>
          <td>
            <input type="checkbox" name="use_tz_{{ z.code }}" {% if srow and srow.is_active %}checked{% endif %}>
          </td>
          <td>
            {{ z.code }}
            <input type="hidden" name="tz_codes" value="{{ z.code }}">
          </td>
          <td>
            <input type="text" name="tz_name_{{ z.code }}" value="{{ srow.display_name if srow else z.default_name }}" style="width:100%;">
          </td>
          <td>
            <input type="number" name="tz_sort_{{ z.code }}" value="{{ srow.sort_order if srow else z.sort_order }}" style="width:100%;">
          </td>
        </tr>
      {% endfor %}
    </tbody>
  </table>

  <button class="btn btn-primary" type="submit">{{ t("common.update", "__common.update__") }}</button>
</form>
{% endif %}
{% endblock %}
