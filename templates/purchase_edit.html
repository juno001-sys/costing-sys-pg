{% extends "base.html" %}

{% block title %}取引編集{% endblock %}

{% block content %}
  <h2>取引編集 (ID: {{ purchase.id }})</h2>

  <form method="post">
    <div>
      <label>店舗：</label>
      <select name="store_id">
        {% for s in stores %}
          <option value="{{ s.id }}" {% if purchase.store_id == s.id %}selected{% endif %}>
            {{ s.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div style="margin-top: 8px;">
      <label>納品日：</label>
      <input type="date" name="delivery_date" value="{{ purchase.delivery_date }}">
    </div>

    <div style="margin-top: 8px;">
      <label>仕入先：</label>
      <select name="supplier_id">
        <option value="">（未設定）</option>
        {% for s in suppliers %}
          <option value="{{ s.id }}" {% if purchase.supplier_id == s.id %}selected{% endif %}>
            {{ s.name }}
          </option>
        {% endfor %}
      </select>
    </div>

    <div style="margin-top: 8px;">
      <label>品目：</label>
      <!-- とりあえず名称のみ表示（本格対応するならセレクト化も可） -->
      <input type="text" value="{{ purchase.item_name }}" readonly>
      <span style="font-size: 12px; color: #666;">コード: {{ purchase.item_code }}</span>
      <input type="hidden" name="item_id" value="{{ purchase.item_id }}">
    </div>

    <div style="margin-top: 8px;">
      <label>数量：</label>
      <input type="text" name="quantity" value="{{ purchase.quantity }}">
    </div>

    <div style="margin-top: 8px;">
      <label>単価：</label>
      <input type="text" name="unit_price" value="{{ purchase.unit_price }}">
    </div>

    <div style="margin-top: 12px;">
      <button type="submit">更新する</button>
      <button
        type="submit"
        name="delete"
        value="1"
        onclick="return confirm('本当に削除しますか？（ソフトデリート）');"
      >
        削除する
      </button>
      <a href="{{ url_for('new_purchase', store_id=purchase.store_id) }}">戻る</a>
    </div>
  </form>
{% endblock %}
