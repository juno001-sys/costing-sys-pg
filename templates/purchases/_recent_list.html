<!-- ============================
     Recent 50 purchases
============================ -->
<h2>{{ t("purchase.recent.title") }}</h2>

<form method="get" style="margin-bottom: 12px;">
  <label style="margin-right: 12px;">
    {{ t("form.store") }}：
    <select name="store_id">
      <option value="">{{ t("common.all_stores") }}</option>
      {% for s in stores %}
        <option value="{{ s.id }}"
                {% if selected_store_id == s.id %}selected{% endif %}>
          {{ s.name }}
        </option>
      {% endfor %}
    </select>
  </label>

  <label style="margin-right: 12px;">
    {{ t("form.period") }}：
    <input type="date" name="from_date" value="{{ from_date or '' }}">
    〜
    <input type="date" name="to_date" value="{{ to_date or '' }}">
  </label>

  <label style="margin-right: 12px;">
    {{ t("form.keyword") }}：
    <input type="text" name="q" value="{{ search_q or '' }}">
  </label>

  <button type="submit">{{ t("common.search") }}</button>
  <a href="{{ url_for('new_purchase', clear='1', store_id=selected_store_id) }}">
    {{ t("common.clear_conditions") }}
  </a>
</form>

<table class="monthly-table">
  <thead>
    <tr>
      <th>{{ t("purchase.delivery_date") }}</th>
      <th>{{ t("form.supplier") }}</th>
      <th>{{ t("form.item") }}</th>
      <th class="num">{{ t("form.quantity") }}</th>
      <th class="num">{{ t("form.unit_price") }}</th>
      <th class="num">{{ t("form.amount") }}</th>
      <th>{{ t("common.edit") }}</th>
    </tr>
  </thead>
  <tbody>
    {% for p in purchases %}
    <tr>
      <td>{{ p.delivery_date }}</td>
      <td>{{ p.supplier_name }}</td>
      <td>{{ p.item_name }}</td>
      <td class="num">{{ "{:,}".format(p.quantity) }}</td>
      <td class="num">{{ "{:,}".format(p.unit_price) }}</td>
      <td class="num">{{ "{:,}".format(p.amount) }}</td>
      <td>
        <a href="{{ url_for('edit_purchase', purchase_id=p.id) }}">{{ t("common.edit") }}</a>
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
