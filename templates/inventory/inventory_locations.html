{% extends "base.html" %}
{% block title %}{{ t("inventory.locations.title") }}{% endblock %}

{% block head_extra %}
<link rel="stylesheet" href="{{ url_for('static', filename='inventory/inventory_locations.css') }}">
{% endblock %}

{% block content %}
<h2>{{ t("inventory.locations.title") }}</h2>

<form method="get" class="form-inline">
  <label class="field-label">{{ t("form.store") }}</label>
  <select name="store_id" onchange="this.form.submit()">
    <option value="">{{ t("common.select") }}</option>
    {% for s in stores %}
      <option value="{{ s.id }}" {% if selected_store_id == s.id %}selected{% endif %}>
        {{ s.name }}
      </option>
    {% endfor %}
  </select>
  <noscript><button type="submit">{{ t("form.show") }}</button></noscript>
</form>

{% if not selected_store_id %}
  <p class="muted" style="margin-top:12px;">{{ t("inventory.locations.hint_select_store") }}</p>
{% endif %}

{% if selected_store_id and not items %}
  <p class="muted" style="margin-top:12px;">{{ t("common.no_data") }}</p>
{% endif %}

{% if items %}
<table class="locations-table">
  <thead>
    <tr>
      <th>{{ t("inventory.item_code") }}</th>
      <th>{{ t("inventory.item_name") }}</th>
      <th>{{ t("inventory.locations.column") }}</th>
    </tr>
  </thead>
  <tbody>
    {% for it in items %}
    <tr>
      <td style="white-space:nowrap;">{{ it.code }}</td>
      <td>{{ it.name }}</td>
      <td>
        {% if it.locations %}
          <div class="loc-list">
            {% for loc in it.locations %}
              <div class="loc-row">
                <span class="loc-area">{{ loc.area }}</span>
                <span class="loc-sep">/</span>
                <span class="loc-zone">{{ loc.temp_zone }}</span>
                <span class="loc-sep">/</span>
                <span class="loc-shelf">
                  {{ loc.shelf_code }}{% if loc.shelf_name %} ({{ loc.shelf_name }}){% endif %}
                </span>
              </div>
            {% endfor %}
          </div>
        {% else %}
          <span class="muted">{{ t("common.unset") }}</span>
        {% endif %}
      </td>
    </tr>
    {% endfor %}
  </tbody>
</table>
{% endif %}
{% endblock %}
