<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <title>{% block title %}TEST Dev{% endblock %}</title>

    <style>
      /* ============================
         全体レイアウト
      ============================ */
      body {
        font-family: system-ui;
        margin: 40px;
      }
      h1 {
        margin-bottom: 24px;
      }

      /* 環境別の背景色（dev / main） */
      body.dev {
        background: #f5fff5;  /* 開発用：うっすらグリーン */
      }
      body.main {
        background: #ffffff;  /* 本番用：白 */
      }

      /* ============================
         横タブメニュー（7タブ）
      ============================ */
      .nav-tabs {
        display: flex;
        flex-wrap: wrap;
        gap: 18px;
        list-style: none;
        padding: 0;
        margin: 0 0 30px 0;
        border-bottom: 2px solid #ddd;
      }

      .nav-tabs li {
        margin: 0;
      }

      .nav-tabs a {
        display: inline-block;
        padding: 8px 14px;
        text-decoration: none;
        color: #333;
        font-weight: 600;
        border-radius: 6px 6px 0 0;
      }

      .nav-tabs a:hover {
        background: #f0f0f0;
      }

      /* 選択中タブ：ヘッダーと同系色 */
      .nav-tabs a.active {
        background: #f0f4ff;          /* ヘッダー行と同じ系統の薄い青 */
        border-bottom: 2px solid #fff;
      }

      /* flash メッセージ用 */
      .flash {
        background: #ffeebb;
        border: 1px solid #e0c97f;
        padding: 10px 16px;
        margin: 20px 0;
        border-radius: 6px;
      }

      /* ============================
         テーブル共通デザイン
      ============================ */
      table {
        border-collapse: collapse;
        /* 幅を 100% 固定にせず、内容に合わせる */
        width: auto;
        max-width: 100%;   /* 画面をはみ出しにくくするセーフティ */
        margin-top: 20px;
      }

      table th,
      table td {
        padding: 6px 10px;
        border: 1px solid #ddd;
        text-align: left;  /* デフォルトは左寄せ */
      }

      /* 数値用クラスは右寄せ */
      table th.num,
      table td.num {
        text-align: right;
      }

      /* ヘッダー行 */
      table thead tr {
        background: #f0f4ff; /* 薄い青 */
        font-weight: bold;
        border-bottom: 2px solid #b8c6e6;
      }

      /* 交互行ストライプ */
      table tbody tr:nth-child(odd) {
        background: #ffffff;
      }
      table tbody tr:nth-child(even) {
        background: #f7f7f7;
      }

      /* 行ホバー */
      table tbody tr:hover {
        background: #e8f2ff;
      }

      /* 合計行（tfoot または class="total-row" に対応） */
      table tfoot tr,
      .total-row {
        background: #fff8d5; /* 薄い黄色 */
        font-weight: bold;
        border-top: 2px solid #e0cd99;
      }

      /* 売上原価行の強調（cost_report 用） */
      .cogs-row td {
        background: #fff3c4; /* もう少し強い黄色 */
        font-weight: 700;
      }

      /* ============================
         月次利用量（usage_report）専用
      ============================ */
      table.monthly-table.usage-table {
        margin-top: 20px;
      }

      /* usage_table ではストライプ無効にして自前で色付け */
      table.monthly-table.usage-table tbody tr:nth-child(odd),
      table.monthly-table.usage-table tbody tr:nth-child(even) {
        background: #ffffff;
      }

      /* 左端：品目、2列目：指標 */
      table.monthly-table.usage-table th,
      table.monthly-table.usage-table td {
        text-align: right;
        white-space: nowrap;
      }
      table.monthly-table.usage-table th:first-child,
      table.monthly-table.usage-table td:first-child {
        text-align: left;
      }
      table.monthly-table.usage-table td.metric-label {
        text-align: left;
        padding-left: 12px;
      }

      /* 指標ごとの色付け */
      table.monthly-table.usage-table .row-metric-pur td {
        /* 当月仕入数：白のまま（基準） */
      }
      table.monthly-table.usage-table .row-metric-use td {
        background: #fff8e8;  /* 利用数（差引）をうっすら強調 */
        font-weight: 600;
      }
      table.monthly-table.usage-table .row-metric-stock td {
        background: #fafafa;  /* 棚卸（次月繰越） */
      }

      /* 数字は右寄せ */
      table.monthly-table.usage-table td.num {
        text-align: right;
      }
    </style>

    {% block head_extra %}{% endblock %}
  </head>

  <body class="{% if 'dev' in g.app_version %}dev{% else %}main{% endif %}">
    <h1>TEST test tst 倉島事業開発 CMS PostGres Dev Env</h1>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="flash">
          {% for msg in messages %}
            <div>{{ msg }}</div>
          {% endfor %}
        </div>
      {% endif %}
    {% endwith %}

    <!-- ============================
         横タブメニュー（全リンク）
    ============================= -->
    <nav>
      <ul class="nav-tabs">
        <li>
          <a href="{{ url_for('new_purchase') }}"
             class="{% if request.endpoint == 'new_purchase' %}active{% endif %}">
            仕入れ入力
          </a>
        </li>

        <li>
          <a href="{{ url_for('inventory_count') }}"
             class="{% if request.endpoint == 'inventory_count' %}active{% endif %}">
            棚卸し入力
          </a>
        </li>

        <li>
          <a href="{{ url_for('purchase_report') }}"
             class="{% if request.endpoint == 'purchase_report' %}active{% endif %}">
            仕入れ照会
          </a>
        </li>

        <li>
          <a href="{{ url_for('usage_report') }}"
             class="{% if request.endpoint == 'usage_report' %}active{% endif %}">
            月次利用量照会
          </a>
        </li>

        <li>
          <a href="{{ url_for('cost_report') }}"
             class="{% if request.endpoint == 'cost_report' %}active{% endif %}">
            売上原価月次推移
          </a>
        </li>

        <li>
          <a href="{{ url_for('suppliers_master') }}"
             class="{% if request.endpoint == 'suppliers_master' %}active{% endif %}">
            仕入先マスタ
          </a>
        </li>

        <li>
          <a href="{{ url_for('items_master') }}"
             class="{% if request.endpoint == 'items_master' %}active{% endif %}">
            品目マスタ
          </a>
        </li>
      </ul>
    </nav>

    {% block content %}{% endblock %}
    {% block body_extra %}{% endblock %}
  </body>
</html>
